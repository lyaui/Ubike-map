{"remainingRequest":"/Users/huangpei-yu/ubike-map/node_modules/babel-loader/lib/index.js!/Users/huangpei-yu/ubike-map/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huangpei-yu/ubike-map/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/ubike-map/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangpei-yu/ubike-map/src/App.vue","mtime":1590225078875},{"path":"/Users/huangpei-yu/ubike-map/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFRhaXBlaSBmcm9tICdAL2Fzc2V0cy9hcmVhLmpzb24nOwppbXBvcnQgTCBmcm9tICdsZWFmbGV0JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdVYmlrZS1tYXAnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjaXR5TWVudTogW10sCiAgICAgIGFyZWFNZW51OiBbXSwKICAgICAgdWJpa2VzOiBbXSwKICAgICAgc2VsZWN0ZWQ6IHsKICAgICAgICBjaXR5OiAn6Ie65YyX5biCJywKICAgICAgICBhcmVhOiAn6JCs6I+v5Y2AJwogICAgICB9LAogICAgICBvc21NYXA6IHt9CiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHNlbGVjdGVkQXJlYTogZnVuY3Rpb24gc2VsZWN0ZWRBcmVhKCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICByZXR1cm4gdm0udWJpa2VzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnNhcmVhID09PSB2bS5zZWxlY3RlZC5hcmVhOwogICAgICB9KTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBzZWxlY3RlZEFyZWE6IGZ1bmN0aW9uIHNlbGVjdGVkQXJlYSgpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdm0udXBkYXRlTWFya2VycygpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgdXBkYXRlTWFya2VyczogZnVuY3Rpb24gdXBkYXRlTWFya2VycygpIHsKICAgICAgdmFyIHZtID0gdGhpczsgLy8g56e76Zmk5qiZ6KiY77yM5L2/55SoIGluc3RhbmNlb2Yg5Yik5pa35piv5ZCm5pivbWFya2Vy54mp5Lu277yM5aaC5p6c5piv5bCx56e76ZmkCgogICAgICB2bS5vc21NYXAuZWFjaExheWVyKGZ1bmN0aW9uIChsYXllcikgewogICAgICAgIGlmIChsYXllciBpbnN0YW5jZW9mIEwuTWFya2VyKSB7CiAgICAgICAgICB2bS5vc21NYXAucmVtb3ZlTGF5ZXIobGF5ZXIpOwogICAgICAgIH0KICAgICAgfSk7IC8vIOaWsOWinuaomeiomOOAgXBvcHVwCgogICAgICB2bS5zZWxlY3RlZEFyZWEuZm9yRWFjaChmdW5jdGlvbiAoYXJlYSkgewogICAgICAgIEwubWFya2VyKFthcmVhLmxhdCwgYXJlYS5sbmddKS5hZGRUbyh2bS5vc21NYXApLmJpbmRQb3B1cCgiPHA+PHN0cm9uZyBzdHlsZT1cImZvbnQtc2l6ZTogMjBweDtcIj4iLmNvbmNhdChhcmVhLnNuYSwgIjwvc3Ryb25nPjwvcD5cbiA8c3Ryb25nIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogI2Q0NTM0NTtcIj5cdTUzRUZcdTc5REZcdTUwMUZcdThFQ0FcdThGMUJcdTUyNjlcdTk5MThcdUZGMUEiKS5jb25jYXQoYXJlYS5zYmksICIgXHU1M0YwPC9zdHJvbmc+PGJyPlxuIFx1NTNFRlx1NTA1Q1x1N0E3QVx1NEY0RFx1NTI2OVx1OTkxODogIikuY29uY2F0KGFyZWEuYmVtcCwgIjxicj5cbiA8c21hbGw+XHU2NzAwXHU1RjhDXHU2NkY0XHU2NUIwXHU2NjQyXHU5NTkzOiAiKS5jb25jYXQoYXJlYS5tZGF5LCAiPC9zbWFsbD4iKSk7CiAgICAgIH0pOyAvLyDnp7vli5XkuK3lv4Ppu54KCiAgICAgIHZtLm9zbU1hcC5wYW5Ubyhbdm0uc2VsZWN0ZWRBcmVhWzBdLmxhdCwgdm0uc2VsZWN0ZWRBcmVhWzBdLmxuZ10pOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICB2bS5jaXR5TWVudSA9IFtUYWlwZWlbMF0ubmFtZV07CiAgICB2bS5hcmVhTWVudSA9IFRhaXBlaVswXS5kaXN0cmljdHMubWFwKGZ1bmN0aW9uIChhcmVhKSB7CiAgICAgIHJldHVybiBhcmVhLm5hbWU7CiAgICB9KTsKICAgIHZhciBhcGkgPSAnaHR0cHM6Ly90Y2didXNmcy5ibG9iLmNvcmUud2luZG93cy5uZXQvYmxvYnlvdWJpa2UvWW91QmlrZVRQLmpzb24nOwogICAgdm0uJGh0dHAuZ2V0KGFwaSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgdm0udWJpa2VzID0gcmVzcG9uc2UuZGF0YS5yZXRWYWw7IC8vIOS9v+eUqCBPYmplY3Qua2V5c+eNsuWPlnt7fSx7fSx7fSx7fSx7fX3nmoTmlrnlvI8KCiAgICAgIHZtLnViaWtlcyA9IE9iamVjdC5rZXlzKHZtLnViaWtlcykubWFwKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICByZXR1cm4gdm0udWJpa2VzW2tleV07CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIHZtID0gdGhpczsgLy8g5Yqg5YWlbGVhZmxldOatpempn++8mmh0dHBzOi8vbGVhZmxldGpzLmNvbS9leGFtcGxlcy9xdWljay1zdGFydC8KICAgIC8vIE9TTeWcsOWcluWPg+iAg++8mmh0dHBzOi8vbGVhZmxldGpzLmNvbS8KCiAgICB2bS5vc21NYXAgPSBMLm1hcCgnbWFwJykuc2V0VmlldyhbMjUuMDQxOTU2LCAxMjEuNTA4NzkxXSwgMTYpOwogICAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJywgewogICAgICBhdHRyaWJ1dGlvbjogJ01hcCBkYXRhICZjb3B5OyA8YSBocmVmPSJodHRwczovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy8iPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycywgPGEgaHJlZj0iaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LXNhLzIuMC8iPkNDLUJZLVNBPC9hPiwgSW1hZ2VyeSDCqSA8YSBocmVmPSJodHRwczovL3d3dy5tYXBib3guY29tLyI+TWFwYm94PC9hPicsCiAgICAgIG1heFpvb206IDE4LAogICAgICBpZDogJ21hcGJveC9zdHJlZXRzLXYxMScsCiAgICAgIHRpbGVTaXplOiA1MTIsCiAgICAgIHpvb21PZmZzZXQ6IC0xLAogICAgICBhY2Nlc3NUb2tlbjogJ3lvdXIubWFwYm94LmFjY2Vzcy50b2tlbicKICAgIH0pLmFkZFRvKHZtLm9zbU1hcCk7CiAgfQp9Ow=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"row no-gutters\">\n      <!-- 選擇地區 -->\n      <div class=\"toolbox col-sm-3 p-2 bg-white\">\n        <div class=\"form-group d-flex\">\n          <label for=\"city\" class=\"col-form-label mr-2 text-right\">縣市</label>\n          <div class=\"flex-fill\">\n            <select id=\"city\" class=\"form-control\" v-model=\"selected.city\">\n              <!-- 製作下拉選單 -->\n              <option v-for=\"city in cityMenu\" :key=\"city\" :value=\"city\">{{ city }}</option>\n            </select>\n          </div>\n        </div>\n        <div class=\"form-group d-flex\">\n          <label for=\"dist\" class=\"col-form-label mr-2 text-right\">地區</label>\n          <div class=\"flex-fill\">\n            <select id=\"dist\" class=\"form-control\" v-model=\"selected.area\">\n              <!-- 製作下拉選單 -->\n              <option v-for=\"area in areaMenu\" :key=\"area\" :value=\"area\">{{ area }}</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      <!-- 顯示地圖和 UBike 站點 -->\n      <div class=\"col-sm-9\">\n        <div id=\"map\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Taipei from '@/assets/area.json';\nimport L from 'leaflet';\n\nexport default {\n  name: 'Ubike-map',\n  data() {\n    return {\n      cityMenu: [],\n      areaMenu: [],\n      ubikes: [],\n      selected: { city: '臺北市', area: '萬華區' },\n      osmMap: {},\n    };\n  },\n  computed: {\n    selectedArea() {\n      const vm = this;\n      return vm.ubikes.filter((item) => item.sarea === vm.selected.area);\n    },\n  },\n  watch: {\n    selectedArea() {\n      const vm = this;\n      vm.updateMarkers();\n    },\n  },\n  methods: {\n    updateMarkers() {\n      const vm = this;\n\n      // 移除標記，使用 instanceof 判斷是否是marker物件，如果是就移除\n      vm.osmMap.eachLayer((layer) => {\n        if (layer instanceof L.Marker) {\n          vm.osmMap.removeLayer(layer);\n        }\n      });\n\n      // 新增標記、popup\n      vm.selectedArea.forEach((area) => {\n        L.marker([area.lat, area.lng]).addTo(vm.osmMap).bindPopup(`<p><strong style=\"font-size: 20px;\">${area.sna}</strong></p>\n <strong style=\"font-size: 16px; color: #d45345;\">可租借車輛剩餘：${area.sbi} 台</strong><br>\n 可停空位剩餘: ${area.bemp}<br>\n <small>最後更新時間: ${area.mday}</small>`);\n      })\n\n      // 移動中心點\n      vm.osmMap.panTo([vm.selectedArea[0].lat, vm.selectedArea[0].lng]);\n    },\n  },\n  created() {\n    const vm = this;\n    vm.cityMenu = [Taipei[0].name];\n    vm.areaMenu = Taipei[0].districts.map((area) => area.name);\n    const api = 'https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json';\n    vm.$http.get(api).then((response) => {\n      vm.ubikes = response.data.retVal;\n      // 使用 Object.keys獲取{{},{},{},{},{}}的方式\n      vm.ubikes = Object.keys(vm.ubikes).map((key) => vm.ubikes[key]);\n    });\n  },\n  mounted() {\n    const vm = this;\n    // 加入leaflet步驟：https://leafletjs.com/examples/quick-start/\n    // OSM地圖參考：https://leafletjs.com/\n    vm.osmMap = L.map('map').setView([25.041956, 121.508791], 16);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n      maxZoom: 18,\n      id: 'mapbox/streets-v11',\n      tileSize: 512,\n      zoomOffset: -1,\n      accessToken: 'your.mapbox.access.token',\n    }).addTo(vm.osmMap);\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import 'bootstrap/scss/bootstrap';\n\n#map {\n  background-color: rgb(235, 235, 235);\n  height: 100vh;\n}\n</style>\n"],"sourceRoot":"src"}]}