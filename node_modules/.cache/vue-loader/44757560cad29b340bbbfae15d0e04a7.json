{"remainingRequest":"/Users/huangpei-yu/ubike-map/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangpei-yu/ubike-map/src/App.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/huangpei-yu/ubike-map/src/App.vue","mtime":1590225078875},{"path":"/Users/huangpei-yu/ubike-map/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangpei-yu/ubike-map/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgJ2Jvb3RzdHJhcC9zY3NzL2Jvb3RzdHJhcCc7CgojbWFwIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjM1LCAyMzUsIDIzNSk7CiAgaGVpZ2h0OiAxMDB2aDsKfQo="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgHA;;AAEA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"row no-gutters\">\n      <!-- 選擇地區 -->\n      <div class=\"toolbox col-sm-3 p-2 bg-white\">\n        <div class=\"form-group d-flex\">\n          <label for=\"city\" class=\"col-form-label mr-2 text-right\">縣市</label>\n          <div class=\"flex-fill\">\n            <select id=\"city\" class=\"form-control\" v-model=\"selected.city\">\n              <!-- 製作下拉選單 -->\n              <option v-for=\"city in cityMenu\" :key=\"city\" :value=\"city\">{{ city }}</option>\n            </select>\n          </div>\n        </div>\n        <div class=\"form-group d-flex\">\n          <label for=\"dist\" class=\"col-form-label mr-2 text-right\">地區</label>\n          <div class=\"flex-fill\">\n            <select id=\"dist\" class=\"form-control\" v-model=\"selected.area\">\n              <!-- 製作下拉選單 -->\n              <option v-for=\"area in areaMenu\" :key=\"area\" :value=\"area\">{{ area }}</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      <!-- 顯示地圖和 UBike 站點 -->\n      <div class=\"col-sm-9\">\n        <div id=\"map\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Taipei from '@/assets/area.json';\nimport L from 'leaflet';\n\nexport default {\n  name: 'Ubike-map',\n  data() {\n    return {\n      cityMenu: [],\n      areaMenu: [],\n      ubikes: [],\n      selected: { city: '臺北市', area: '萬華區' },\n      osmMap: {},\n    };\n  },\n  computed: {\n    selectedArea() {\n      const vm = this;\n      return vm.ubikes.filter((item) => item.sarea === vm.selected.area);\n    },\n  },\n  watch: {\n    selectedArea() {\n      const vm = this;\n      vm.updateMarkers();\n    },\n  },\n  methods: {\n    updateMarkers() {\n      const vm = this;\n\n      // 移除標記，使用 instanceof 判斷是否是marker物件，如果是就移除\n      vm.osmMap.eachLayer((layer) => {\n        if (layer instanceof L.Marker) {\n          vm.osmMap.removeLayer(layer);\n        }\n      });\n\n      // 新增標記、popup\n      vm.selectedArea.forEach((area) => {\n        L.marker([area.lat, area.lng]).addTo(vm.osmMap).bindPopup(`<p><strong style=\"font-size: 20px;\">${area.sna}</strong></p>\n <strong style=\"font-size: 16px; color: #d45345;\">可租借車輛剩餘：${area.sbi} 台</strong><br>\n 可停空位剩餘: ${area.bemp}<br>\n <small>最後更新時間: ${area.mday}</small>`);\n      })\n\n      // 移動中心點\n      vm.osmMap.panTo([vm.selectedArea[0].lat, vm.selectedArea[0].lng]);\n    },\n  },\n  created() {\n    const vm = this;\n    vm.cityMenu = [Taipei[0].name];\n    vm.areaMenu = Taipei[0].districts.map((area) => area.name);\n    const api = 'https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json';\n    vm.$http.get(api).then((response) => {\n      vm.ubikes = response.data.retVal;\n      // 使用 Object.keys獲取{{},{},{},{},{}}的方式\n      vm.ubikes = Object.keys(vm.ubikes).map((key) => vm.ubikes[key]);\n    });\n  },\n  mounted() {\n    const vm = this;\n    // 加入leaflet步驟：https://leafletjs.com/examples/quick-start/\n    // OSM地圖參考：https://leafletjs.com/\n    vm.osmMap = L.map('map').setView([25.041956, 121.508791], 16);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n      maxZoom: 18,\n      id: 'mapbox/streets-v11',\n      tileSize: 512,\n      zoomOffset: -1,\n      accessToken: 'your.mapbox.access.token',\n    }).addTo(vm.osmMap);\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import 'bootstrap/scss/bootstrap';\n\n#map {\n  background-color: rgb(235, 235, 235);\n  height: 100vh;\n}\n</style>\n"]}]}